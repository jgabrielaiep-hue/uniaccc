<ion-header translucent="true" class="header">
  <ion-toolbar>
    <ion-title>
      <div class="title">Mis Reservas</div>
      <div class="subtitle">Gestiona tus servicios agendados</div>
    </ion-title>

    <ion-buttons slot="end">
      <ion-button fill="clear" (click)="load()">
        <ion-icon name="refresh-outline" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content fullscreen="true" class="page">
  <!-- Skeleton -->
  <ng-container *ngIf="loading; else content">
    <div class="skeleton-list">
      <ion-card class="skeleton-card" *ngFor="let _ of skeletonItems">
        <ion-card-content>
          <ion-skeleton-text animated style="width: 40%; height: 14px"></ion-skeleton-text>
          <ion-skeleton-text animated style="width: 60%; height: 16px; margin-top: 8px"></ion-skeleton-text>
          <ion-skeleton-text animated style="width: 80%; height: 12px; margin-top: 12px"></ion-skeleton-text>
        </ion-card-content>
      </ion-card>
    </div>
  </ng-container>

  <!-- Content -->
  <ng-template #content>
    <!-- Empty -->
    <div class="empty" *ngIf="bookings.length === 0">
      <ion-icon name="calendar-outline"></ion-icon>
      <h2>No tienes reservas</h2>
      <p>Cuando agendes un servicio, aparecerá aquí.</p>
      <ion-button routerLink="/tabs/tab1">
        Buscar servicios
      </ion-button>
    </div>

    <!-- Timeline -->
    <div class="timeline" *ngIf="bookings.length > 0">
      <ion-card class="booking-card" *ngFor="let b of bookings">
        <div class="status-bar" [class]="b.status"></div>

        <ion-card-content>
          <div class="top">
            <div>
              <h3>{{ b.providerName }}</h3>
              <p class="service">{{ b.serviceName }}</p>
            </div>

            <ion-badge [color]="statusColor(b.status)">
              {{ statusLabel(b.status) }}
            </ion-badge>
          </div>

          <div class="meta">
            <div>
              <ion-icon name="calendar-outline"></ion-icon>
              {{ b.date }}
            </div>
            <div>
              <ion-icon name="time-outline"></ion-icon>
              {{ b.time }}
            </div>
            <div>
              <ion-icon name="cash-outline"></ion-icon>
              ${{ b.price }}
            </div>
          </div>

          <div class="actions">
            <ion-button size="small" fill="outline">
              Ver detalle
            </ion-button>

            <ion-button
              size="small"
              color="danger"
              fill="clear"
              *ngIf="b.status === 'pending'"
            >
              Cancelar
            </ion-button>
          </div>
        </ion-card-content>
      </ion-card>
    </div>
  </ng-template>
</ion-content>
